import{u as S,e as E,r as n,h as R,j as e,c as k}from"./index-DYvV5D9I.js";import{A as y}from"./AdminPageHeader-DGBmdOnC.js";import"./ArrowLeftIcon-Cigvgpax.js";function B(){if(typeof window>"u")return null;const d=window.API_BASE_URL;return d?d.replace(/\/$/,""):null}const L=["image/png","image/jpeg","image/jpg","image/gif","image/webp"],I=()=>{const{user:d}=S(),{logo:c}=E(),[s,N]=n.useState(null),[u,v]=n.useState("Funkedupshift"),[i,p]=n.useState(null),[g,x]=n.useState(!1),[f,m]=n.useState(null),[h,a]=n.useState(null);if(!R(d??null,"superadmin"))return e.jsx("div",{className:"space-y-6",children:e.jsx(y,{title:"Branding",description:"Only superadmin users can manage global branding assets."})});const U=r=>{var o;const l=(o=r.target.files)==null?void 0:o[0];N(l??null),m(null),a(null),i&&(URL.revokeObjectURL(i),p(null)),l&&p(URL.createObjectURL(l))},P=async r=>{if(r.preventDefault(),a(null),m(null),!s){a("Choose an image file first.");return}const l=s.type||"image/png";if(!L.includes(l)){a("Logo must be PNG, JPEG, GIF, or WEBP.");return}const o=B();if(!o){a("API URL not configured.");return}const b=window;if(!b.auth||typeof b.auth.getAccessToken!="function"){a("Auth not initialized.");return}x(!0);try{const t=await k(`${o}/branding/logo`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contentType:l,alt:u})});if(!t.ok){const A=await t.text();throw new Error(A||`Metadata request failed with ${t.status}`)}const j=await t.json();if(!j.uploadUrl)throw new Error("uploadUrl missing from response.");const w=await fetch(j.uploadUrl,{method:"PUT",headers:{"Content-Type":l},body:s});if(!w.ok)throw new Error(`Upload failed with ${w.status}`);m("Logo updated. It may take a moment for caches to refresh.")}catch(t){a((t==null?void 0:t.message)??"Failed to update logo.")}finally{x(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{title:"Branding",description:"Upload a new global logo. Used in the navigation bar and shared surfaces."}),e.jsxs("form",{className:"card p-6 space-y-4 max-w-md",onSubmit:P,children:[e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("label",{className:"block text-slate-200",children:"Logo image"}),c&&!i&&e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsx("p",{className:"text-slate-200",children:"Current logo"}),e.jsx("div",{className:"inline-flex items-center rounded-lg border border-slate-800 bg-slate-950 p-2",children:e.jsx("img",{src:c.url,alt:c.alt,className:"h-12 w-auto rounded-md object-contain"})})]}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/gif,image/webp",onChange:U,className:"block w-full text-xs text-slate-300 file:mr-3 file:rounded-md file:border-0 file:bg-slate-800 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-slate-100 hover:file:bg-slate-700"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PNG, JPEG, GIF, or WEBP. Recommended square or horizontal layout."})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("label",{className:"block text-slate-200",children:"Alt text"}),e.jsx("input",{type:"text",value:u,onChange:r=>v(r.target.value),className:"input-field"})]}),i&&e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"text-slate-200",children:"Preview"}),e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-800 bg-slate-950 p-2",children:[e.jsx("img",{src:i,alt:"Preview",className:"h-12 w-auto rounded-md object-contain"}),e.jsx("span",{className:"ml-3 text-xs text-slate-400 truncate max-w-[12rem]",children:s==null?void 0:s.name})]})]}),e.jsx("button",{type:"submit",disabled:g||!s,className:"btn-primary disabled:opacity-50",children:g?"Updatingâ€¦":"Update logo"}),f&&e.jsx("div",{className:"rounded-md border border-emerald-500/60 bg-emerald-500/10 px-3 py-2 text-xs text-emerald-200",children:f}),h&&e.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-xs text-red-200",children:h})]})]})};export{I as default};
