import{u as p,r as d,f as b,j as t,h as w,L as j}from"./index-BLy7dBGz.js";const x="funkedupshift_internet_dashboard",N=5*60*1e3;function S(){if(typeof window>"u")return null;const a=window.API_BASE_URL;return a?a.replace(/\/$/,""):null}function v(){try{const a=localStorage.getItem(x);if(!a)return null;const s=JSON.parse(a);return!(s!=null&&s.sites)||!(s!=null&&s.lastFetchTime)||Date.now()-new Date(s.lastFetchTime).getTime()>=N?null:s.sites}catch{return null}}function y(a){try{localStorage.setItem(x,JSON.stringify({sites:a,lastFetchTime:new Date().toISOString()}))}catch{}}const A=()=>{const{user:a}=p(),[s,o]=d.useState([]),[g,c]=d.useState(!0),[m,i]=d.useState(null),h=d.useCallback(async()=>{const r=S(),e=v();if(e&&e.length>0){o(e),c(!1),i(null);return}if(!r){i("API URL not set."),c(!1);return}c(!0),i(null);try{const n=await b(`${r}/internet-dashboard`);if(!n.ok){const f=await n.text();throw new Error(f||`HTTP ${n.status}`)}const l=await n.json(),u=Array.isArray(l.sites)?l.sites:[];u.length>0?(y(u),o(u)):(i(e!=null&&e.length?void 0:"No data returned."),e!=null&&e.length&&o(e))}catch(n){const l=n instanceof Error?n.message:"Failed to load dashboard.";e&&e.length>0?(o(e),i(null)):(i(l),o([]))}finally{c(!1)}},[]);return d.useEffect(()=>{h()},[h]),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-50",children:"Internet dashboard"}),t.jsxs("div",{className:"rounded-xl border border-teal-800/60 bg-gradient-to-br from-teal-900/40 to-teal-950/60 p-4 shadow-lg",children:[t.jsx("p",{className:"text-sm font-medium text-teal-100",children:"Live status of popular sites"}),t.jsx("p",{className:"mt-1 text-xs text-teal-200/80",children:"Refreshes when data is older than 5 minutes"}),w(a??null,"superadmin")&&t.jsx("p",{className:"mt-2",children:t.jsx(j,{to:"/admin/internet-dashboard",className:"text-brand-orange hover:text-orange-400 text-sm",children:"Edit sites list"})})]}),g&&t.jsx("p",{className:"text-sm text-slate-400",children:"Loadingâ€¦"}),m&&!s.length&&t.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-xs text-red-200",children:m}),t.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(140px,1fr))] gap-3",children:s.map(r=>{const e=(r.status||"down").toLowerCase(),n=e==="up"?"border-emerald-500/50 bg-emerald-500/15 text-emerald-200":e==="degraded"?"border-amber-500/50 bg-amber-500/15 text-amber-200":"border-red-500/50 bg-red-500/15 text-red-200",l=r.responseTimeMs!=null?`${r.responseTimeMs} ms`:null;return t.jsxs("div",{className:`rounded-lg border p-3 text-center text-sm transition-all duration-200 hover:scale-[1.02] hover:shadow-lg ${n}`,children:[t.jsx("a",{href:`https://${r.domain}`,target:"_blank",rel:"noopener noreferrer",className:"font-semibold break-all hover:underline block",children:r.domain}),t.jsx("div",{className:"mt-1 text-xs capitalize opacity-90",children:e}),l&&t.jsx("div",{className:"mt-0.5 text-[11px] opacity-75",children:l})]},r.domain)})})]})};export{A as default};
