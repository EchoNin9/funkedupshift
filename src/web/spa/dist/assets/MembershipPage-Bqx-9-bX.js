import{u as rt,d as ot,a as lt,r,h as it,j as t,c as p}from"./index-Bal_br-M.js";import{A as ze}from"./AdminPageHeader-DZ00d26O.js";import{A as dt}from"./AdminTabs-DpYvkwQT.js";import"./ArrowLeftIcon-DBoqJR81.js";const _={admin:"SuperAdmin",manager:"Manager",user:"User"},qe=["admin","manager","user"],ae=[{value:-8,label:"UTC-8"},{value:-5,label:"UTC-5"},{value:0,label:"UTC+0/GMT"}];function x(){if(typeof window>"u")return null;const d=window.API_BASE_URL;return d?d.replace(/\/$/,""):null}function ct(d,b,u){if(!d&&!u)return"—";if(!d)return u?`from ${u}`:"—";try{const j=new Date(d);if(isNaN(j.getTime()))return d+(u?` from ${u}`:"");const h=j.getTime()+(b||0)*36e5,f=new Date(h),c=y=>y<10?"0"+y:""+y,g=f.getUTCFullYear(),R=c(f.getUTCMonth()+1),N=c(f.getUTCDate()),z=c(f.getUTCHours()),E=c(f.getUTCMinutes()),w=ae.find(y=>y.value===b),G=w?w.label:b<0?"UTC"+b:"UTC+"+b;let v=`${g}-${R}-${N} ${z}:${E} ${G}`;return u&&(v+=` from ${u}`),v}catch{return d+(u?` from ${u}`:"")}}const ht=()=>{const{user:d}=rt(),b=ot(),[u,j]=lt(),h=u.get("tab"),f=h==="groups"?"groups":h==="roles"?"roles":"users",[c,g]=r.useState(f);r.useEffect(()=>{g(h==="groups"?"groups":h==="roles"?"roles":"users")},[h]);const R=e=>{g(e);const s=new URLSearchParams(u);e==="groups"?s.set("tab","groups"):e==="roles"?s.set("tab","roles"):s.delete("tab"),j(s)},[N,z]=r.useState([]),[E,w]=r.useState(!0),[G,v]=r.useState(null),[y,Je]=r.useState(""),[ne,re]=r.useState(-8),[k,q]=r.useState([]),[Ye,D]=r.useState(!0),[oe,C]=r.useState(null),[J,le]=r.useState(""),[ie,de]=r.useState(""),[ce,ue]=r.useState(""),[me,pe]=r.useState(!1),[xe,be]=r.useState(null),[U,he]=r.useState(null),[Y,K]=r.useState(""),[fe,W]=r.useState(""),[ge,ye]=r.useState(!1),[je,A]=r.useState(null),[L,Ne]=r.useState(null),[we,Z]=r.useState([]),[Ke,P]=r.useState(!0),[ve,S]=r.useState(null),[Q,Ce]=r.useState(""),[V,Se]=r.useState([]),[X,Re]=r.useState([]),[Ee,ke]=r.useState(!1),[Ue,Te]=r.useState(null),[T,$e]=r.useState(null),[I,H]=r.useState([]),[F,ee]=r.useState([]),[Ge,De]=r.useState(!1),[Ae,M]=r.useState(null),[O,Le]=r.useState(null),$=it(d??null,"manager"),B=(d==null?void 0:d.role)==="superadmin",Pe=async e=>{var a;const s=x();if(!s){v("API URL not set."),w(!1);return}if(!((a=window.auth)!=null&&a.getAccessToken)){v("Sign in required."),w(!1);return}w(!0),v(null);try{let o=`${s}/admin/users`;e&&(o+=`?paginationToken=${encodeURIComponent(e)}`);const n=await p(o);if(!n.ok){const m=await n.json().catch(()=>({}));throw new Error(m.error||"Failed to load users")}const l=await n.json();z(m=>e?[...m,...l.users??[]]:l.users??[]),Je(l.paginationToken??"")}catch(o){v((o==null?void 0:o.message)??"Failed to load users")}finally{w(!1)}},We=async e=>{const s=x();if(!s)return{cognitoGroups:[],customGroups:[]};try{const i=await p(`${s}/admin/users/${encodeURIComponent(e.username)}/groups`);if(!i.ok)return{cognitoGroups:[],customGroups:[]};const a=await i.json();return{cognitoGroups:a.cognitoGroups??[],customGroups:a.customGroups??[]}}catch{return{cognitoGroups:[],customGroups:[]}}},Ie=async()=>{var i;const e=x();if(!e){C("API URL not set."),D(!1);return}if(!((i=window.auth)!=null&&i.getAccessToken)){C("Sign in required."),D(!1);return}D(!0),C(null);try{const a=await p(`${e}/admin/groups`);if(!a.ok)throw new Error(await a.text());const n=((await a.json()).groups??[]).map(l=>({name:l.name??(l.PK??"").replace("GROUP#",""),description:l.description,permissions:Array.isArray(l.permissions)?l.permissions:[]}));n.sort((l,m)=>l.name.toLowerCase().localeCompare(m.name.toLowerCase())),q(n)}catch(a){C((a==null?void 0:a.message)??"Failed to load groups")}finally{D(!1)}};r.useEffect(()=>{const e=parseInt(sessionStorage.getItem("funkedupshift_lastlogin_tz")??"-8",10);!isNaN(e)&&ae.some(s=>s.value===e)&&re(e)},[]),r.useEffect(()=>{$&&c==="users"&&Pe()},[$,c]),r.useEffect(()=>{$&&(c==="groups"||c==="roles")&&Ie()},[$,c]);const Fe=async()=>{var i;const e=x();if(!e){S("API URL not set."),P(!1);return}if(!((i=window.auth)!=null&&i.getAccessToken)){S("Sign in required."),P(!1);return}P(!0),S(null);try{const a=await p(`${e}/admin/roles`);if(!a.ok){const n=await a.json().catch(()=>({}));throw new Error(n.error||"Failed to load roles")}const o=await a.json();Z(o.roles??[])}catch(a){S((a==null?void 0:a.message)??"Failed to load roles")}finally{P(!1)}};r.useEffect(()=>{B&&c==="roles"&&Fe()},[B,c]);const Ze=e=>{b(`/admin/users/edit?username=${encodeURIComponent(e.username)}&email=${encodeURIComponent(e.email??"")}&status=${encodeURIComponent(e.status??"")}`)},Qe=(e,s)=>{const i=[];return(e||[]).forEach(a=>{const o=_[a]||a,n=a==="admin"?"bg-amber-500/20 text-amber-200":a==="manager"?"bg-blue-500/20 text-blue-200":"bg-slate-600/30 text-slate-300";i.push(t.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs mr-1 ${n}`,children:o},`c-${a}`))}),(s||[]).forEach(a=>{i.push(t.jsx("span",{className:"inline-block px-2 py-0.5 rounded text-xs mr-1 bg-emerald-500/20 text-emerald-200",children:a},`x-${a}`))}),i.length?i:t.jsx("span",{className:"text-slate-500",children:"—"})},Ve=e=>{he(e.name),K(e.description??""),W((e.permissions??[]).join(", ")),A(null)},te=()=>{he(null),K(""),W(""),A(null)},Xe=async e=>{var n;e.preventDefault();const s=J.trim();if(!s)return;const i=x();if(!i||!((n=window.auth)!=null&&n.getAccessToken))return;const o=ce.split(",").map(l=>l.trim()).filter(Boolean);pe(!0),be(null),C(null);try{const l=await p(`${i}/admin/groups`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,description:ie.trim(),permissions:o})});if(!l.ok){const m=await l.json().catch(()=>({}));throw new Error(m.error||"Failed to create group")}le(""),de(""),ue(""),be("Group created."),Ie()}catch(l){C((l==null?void 0:l.message)??"Failed to create group")}finally{pe(!1)}},He=async e=>{var o;if(e.preventDefault(),!U)return;const s=x();if(!s||!((o=window.auth)!=null&&o.getAccessToken))return;const a=fe.split(",").map(n=>n.trim()).filter(Boolean);ye(!0),A(null);try{const n=await p(`${s}/admin/groups/${encodeURIComponent(U)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({description:Y,permissions:a})});if(!n.ok){const l=await n.json().catch(()=>({}));throw new Error(l.error||"Failed to update group")}q(l=>l.map(m=>m.name===U?{...m,description:Y,permissions:a}:m)),te()}catch(n){A((n==null?void 0:n.message)??"Failed to update group")}finally{ye(!1)}},Me=async e=>{var a;if(!window.confirm(`Delete group "${e}"? Members will lose access.`))return;const s=x();if(!(!s||!((a=window.auth)!=null&&a.getAccessToken))){Ne(e);try{const o=await p(`${s}/admin/groups/${encodeURIComponent(e)}`,{method:"DELETE"});if(!o.ok){const n=await o.json().catch(()=>({}));throw new Error(n.error||"Failed to delete group")}q(n=>n.filter(l=>l.name!==e)),U===e&&te()}catch(o){C((o==null?void 0:o.message)??"Failed to delete group")}finally{Ne(null)}}},et=e=>{const s=parseInt(e.target.value,10);re(s),sessionStorage.setItem("funkedupshift_lastlogin_tz",String(s))},Oe=(e,s,i)=>{s.includes(e)?i(s.filter(a=>a!==e)):i([...s,e])},Be=(e,s,i)=>{s.includes(e)?i(s.filter(a=>a!==e)):i([...s,e])},tt=async e=>{var o;e.preventDefault();const s=Q.trim();if(!s)return;const i=x();if(!(!i||!((o=window.auth)!=null&&o.getAccessToken))){ke(!0),Te(null),S(null);try{const n=await p(`${i}/admin/roles`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:s,cognitoGroups:V,customGroups:X})});if(!n.ok){const l=await n.json().catch(()=>({}));throw new Error(l.error||"Failed to create role")}Ce(""),Se([]),Re([]),Te("Role created."),Fe()}catch(n){S((n==null?void 0:n.message)??"Failed to create role")}finally{ke(!1)}}},st=e=>{$e(e.name),H(e.cognitoGroups??[]),ee(e.customGroups??[]),M(null)},se=()=>{$e(null),H([]),ee([]),M(null)},at=async e=>{var a;if(e.preventDefault(),!T)return;const s=x();if(!(!s||!((a=window.auth)!=null&&a.getAccessToken))){De(!0),M(null);try{const o=await p(`${s}/admin/roles/${encodeURIComponent(T)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({cognitoGroups:I,customGroups:F})});if(!o.ok){const n=await o.json().catch(()=>({}));throw new Error(n.error||"Failed to update role")}Z(n=>n.map(l=>l.name===T?{...l,cognitoGroups:I,customGroups:F}:l)),se()}catch(o){M((o==null?void 0:o.message)??"Failed to update role")}finally{De(!1)}}},_e=async e=>{var a;if(!window.confirm(`Delete role "${e}"?`))return;const s=x();if(!(!s||!((a=window.auth)!=null&&a.getAccessToken))){Le(e);try{const o=await p(`${s}/admin/roles/${encodeURIComponent(e)}`,{method:"DELETE"});if(!o.ok){const n=await o.json().catch(()=>({}));throw new Error(n.error||"Failed to delete role")}Z(n=>n.filter(l=>l.name!==e)),T===e&&se()}catch(o){S((o==null?void 0:o.message)??"Failed to delete role")}finally{Le(null)}}};if(!$)return t.jsx("div",{className:"space-y-6",children:t.jsx(ze,{title:"Membership",description:"Manager or SuperAdmin access is required."})});const nt=[{id:"users",label:"Users"},{id:"groups",label:"Groups"},...B?[{id:"roles",label:"Roles"}]:[]];return t.jsxs("div",{className:"space-y-6",children:[t.jsx(ze,{title:"Membership",description:"Manage users and groups."}),t.jsx(dt,{tabs:nt,activeId:c,onSelect:e=>R(e)}),c==="users"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("label",{htmlFor:"tz-select",className:"text-slate-500",children:"Last login timezone:"}),t.jsx("select",{id:"tz-select",value:ne,onChange:et,className:"rounded border border-slate-700 bg-slate-950 px-2 py-1 text-slate-200 text-sm",children:ae.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))})]}),G&&t.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:G}),t.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-800",children:t.jsxs("table",{className:"min-w-full divide-y divide-slate-800",children:[t.jsx("thead",{className:"bg-slate-900/80",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Email"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Status"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Last login"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"System Roles"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase",children:"Custom Groups"})]})}),t.jsx("tbody",{className:"divide-y divide-slate-800",children:E&&N.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-slate-500",children:"Loading…"})}):N.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-slate-500",children:"No users found."})}):N.map(e=>t.jsx(ut,{user:e,tzOffset:ne,formatLastLogin:ct,renderGroupBadges:Qe,loadUserGroups:We,onClick:()=>Ze(e)},e.username))})]})}),y&&t.jsx("div",{className:"flex justify-center",children:t.jsx("button",{type:"button",onClick:()=>Pe(y),disabled:E,className:"rounded-md border border-slate-700 px-4 py-2 text-sm font-medium text-slate-200 hover:bg-slate-800 disabled:opacity-50",children:E?"Loading…":"Load more"})})]}),c==="groups"&&t.jsxs(t.Fragment,{children:[t.jsxs("form",{className:"space-y-3 max-w-md",onSubmit:Xe,children:[t.jsx("h2",{className:"text-sm font-medium text-slate-300",children:"Create group"}),t.jsx("input",{type:"text",value:J,onChange:e=>le(e.target.value),placeholder:"Name (alphanumeric, underscore, hyphen)",required:!0,className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"}),t.jsx("input",{type:"text",value:ie,onChange:e=>de(e.target.value),placeholder:"Description (optional)",className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"}),t.jsx("input",{type:"text",value:ce,onChange:e=>ue(e.target.value),placeholder:"Permissions (comma-separated, e.g. media:edit, sites:add)",className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"}),t.jsx("button",{type:"submit",disabled:me||!J.trim(),className:"inline-flex items-center justify-center rounded-md bg-brand-orange px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-orange-500 disabled:opacity-50",children:me?"Creating…":"Create"}),xe&&t.jsx("div",{className:"rounded-md border border-emerald-500/60 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-200",children:xe}),oe&&t.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:oe})]}),t.jsxs("section",{children:[t.jsx("h2",{className:"text-sm font-medium text-slate-300 mb-2",children:"Custom groups"}),Ye?t.jsx("p",{className:"text-sm text-slate-500",children:"Loading…"}):k.length===0?t.jsx("p",{className:"text-sm text-slate-500",children:"No custom groups yet. Create one above."}):t.jsx("ul",{className:"space-y-2",children:k.map(e=>t.jsx("li",{className:"rounded-lg border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm",children:U===e.name?t.jsxs("form",{onSubmit:He,className:"space-y-2",children:[t.jsx("span",{className:"font-medium text-slate-200",children:e.name}),t.jsx("input",{type:"text",value:Y,onChange:s=>K(s.target.value),placeholder:"Description (optional)",className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"}),t.jsx("input",{type:"text",value:fe,onChange:s=>W(s.target.value),placeholder:"Permissions (comma-separated)",className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsx("button",{type:"submit",disabled:ge,className:"rounded-md bg-brand-orange px-3 py-1.5 text-xs font-medium text-slate-950 hover:bg-orange-500 disabled:opacity-50",children:ge?"Saving…":"Save"}),t.jsx("button",{type:"button",onClick:te,className:"rounded-md border border-slate-700 px-3 py-1.5 text-xs font-medium text-slate-300 hover:bg-slate-800",children:"Cancel"}),t.jsx("button",{type:"button",onClick:()=>Me(e.name),disabled:L===e.name,className:"rounded-md border border-red-500/60 px-3 py-1.5 text-xs font-medium text-red-400 hover:bg-red-500/20 disabled:opacity-50",children:L===e.name?"Deleting…":"Delete"})]}),je&&t.jsx("p",{className:"text-xs text-red-400",children:je})]}):t.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium text-slate-200",children:e.name}),e.description&&t.jsx("span",{className:"text-slate-500 ml-2",children:e.description}),e.permissions&&e.permissions.length>0&&t.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Permissions: ",e.permissions.join(", ")]})]}),t.jsxs("div",{className:"flex gap-2 shrink-0",children:[t.jsx("button",{type:"button",onClick:()=>Ve(e),className:"rounded-md border border-slate-700 px-2 py-1 text-xs font-medium text-slate-300 hover:bg-slate-800",children:"Edit"}),t.jsx("button",{type:"button",onClick:()=>Me(e.name),disabled:L===e.name,className:"rounded-md border border-red-500/60 px-2 py-1 text-xs font-medium text-red-400 hover:bg-red-500/20 disabled:opacity-50",children:L===e.name?"Deleting…":"Delete"})]})]})},e.name))})]})]}),c==="roles"&&B&&t.jsxs(t.Fragment,{children:[t.jsxs("form",{className:"space-y-3 max-w-md",onSubmit:tt,children:[t.jsx("h2",{className:"text-sm font-medium text-slate-300",children:"Create role"}),t.jsx("p",{className:"text-xs text-slate-500",children:"Define a named role by selecting Cognito groups and custom groups. Use for impersonation."}),t.jsx("input",{type:"text",value:Q,onChange:e=>Ce(e.target.value),placeholder:"Role name (e.g. Squash Manager)",required:!0,className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Cognito groups"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:qe.map(e=>t.jsx("button",{type:"button",onClick:()=>Oe(e,V,Se),className:`rounded-md px-2 py-1 text-xs font-medium ${V.includes(e)?"bg-blue-500/30 text-blue-200":"border border-slate-600 text-slate-400 hover:bg-slate-800"}`,children:_[e]||e},e))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Custom groups"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[k.map(e=>t.jsx("button",{type:"button",onClick:()=>Be(e.name,X,Re),className:`rounded-md px-2 py-1 text-xs font-medium ${X.includes(e.name)?"bg-emerald-500/30 text-emerald-200":"border border-slate-600 text-slate-400 hover:bg-slate-800"}`,children:e.name},e.name)),k.length===0&&t.jsx("span",{className:"text-xs text-slate-500",children:"Create groups first."})]})]}),t.jsx("button",{type:"submit",disabled:Ee||!Q.trim(),className:"inline-flex items-center justify-center rounded-md bg-brand-orange px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-orange-500 disabled:opacity-50",children:Ee?"Creating…":"Create"}),Ue&&t.jsx("div",{className:"rounded-md border border-emerald-500/60 bg-emerald-500/10 px-3 py-2 text-sm text-emerald-200",children:Ue}),ve&&t.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:ve})]}),t.jsxs("section",{children:[t.jsx("h2",{className:"text-sm font-medium text-slate-300 mb-2",children:"Defined roles"}),Ke?t.jsx("p",{className:"text-sm text-slate-500",children:"Loading…"}):we.length===0?t.jsx("p",{className:"text-sm text-slate-500",children:"No roles yet. Create one above."}):t.jsx("ul",{className:"space-y-2",children:we.map(e=>t.jsx("li",{className:"rounded-lg border border-slate-800 bg-slate-950/60 px-3 py-2 text-sm",children:T===e.name?t.jsxs("form",{onSubmit:at,className:"space-y-2",children:[t.jsx("span",{className:"font-medium text-slate-200",children:e.name}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Cognito groups"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:qe.map(s=>t.jsx("button",{type:"button",onClick:()=>Oe(s,I,H),className:`rounded-md px-2 py-1 text-xs ${I.includes(s)?"bg-blue-500/30 text-blue-200":"border border-slate-600 text-slate-400"}`,children:_[s]||s},s))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Custom groups"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(s=>t.jsx("button",{type:"button",onClick:()=>Be(s.name,F,ee),className:`rounded-md px-2 py-1 text-xs ${F.includes(s.name)?"bg-emerald-500/30 text-emerald-200":"border border-slate-600 text-slate-400"}`,children:s.name},s.name))})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{type:"submit",disabled:Ge,className:"rounded-md bg-brand-orange px-3 py-1.5 text-xs font-medium text-slate-950 hover:bg-orange-500 disabled:opacity-50",children:Ge?"Saving…":"Save"}),t.jsx("button",{type:"button",onClick:se,className:"rounded-md border border-slate-700 px-3 py-1.5 text-xs text-slate-300 hover:bg-slate-800",children:"Cancel"}),t.jsx("button",{type:"button",onClick:()=>_e(e.name),disabled:O===e.name,className:"rounded-md border border-red-500/60 px-3 py-1.5 text-xs text-red-400 hover:bg-red-500/20 disabled:opacity-50",children:O===e.name?"Deleting…":"Delete"})]}),Ae&&t.jsx("p",{className:"text-xs text-red-400",children:Ae})]}):t.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("span",{className:"font-medium text-slate-200",children:e.name}),t.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[(e.cognitoGroups??[]).map(s=>t.jsx("span",{className:"inline-block px-2 py-0.5 rounded text-xs bg-blue-500/20 text-blue-200",children:_[s]||s},`c-${s}`)),(e.customGroups??[]).map(s=>t.jsx("span",{className:"inline-block px-2 py-0.5 rounded text-xs bg-emerald-500/20 text-emerald-200",children:s},`x-${s}`))]})]}),t.jsxs("div",{className:"flex gap-2 shrink-0",children:[t.jsx("button",{type:"button",onClick:()=>st(e),className:"rounded-md border border-slate-700 px-2 py-1 text-xs text-slate-300 hover:bg-slate-800",children:"Edit"}),t.jsx("button",{type:"button",onClick:()=>_e(e.name),disabled:O===e.name,className:"rounded-md border border-red-500/60 px-2 py-1 text-xs text-red-400 hover:bg-red-500/20 disabled:opacity-50",children:O===e.name?"Deleting…":"Delete"})]})]})},e.name))})]})]})]})},ut=({user:d,tzOffset:b,formatLastLogin:u,renderGroupBadges:j,loadUserGroups:h,onClick:f})=>{const[c,g]=r.useState(null);return r.useEffect(()=>{let R=!1;return h(d).then(N=>{R||g(N)}),()=>{R=!0}},[d.username]),t.jsxs("tr",{className:"cursor-pointer hover:bg-slate-800/50 transition-colors",onClick:f,children:[t.jsx("td",{className:"px-4 py-3 text-sm text-slate-200",children:d.email||d.username||"—"}),t.jsx("td",{className:"px-4 py-3 text-sm text-slate-400",children:d.status||"—"}),t.jsx("td",{className:"px-4 py-3 text-sm text-slate-400",children:u(d.lastLoginAt??"",b,d.lastLoginIp)}),t.jsx("td",{className:"px-4 py-3 text-sm",children:c?j(c.cognitoGroups,[]):t.jsx("span",{className:"text-slate-500",children:"…"})}),t.jsx("td",{className:"px-4 py-3 text-sm",children:c?j([],c.customGroups):t.jsx("span",{className:"text-slate-500",children:"…"})})]})};export{ht as default};
