import{u as S,e as k,r as n,h as A,j as e,c as E}from"./index-CqR0r56c.js";function R(){if(typeof window>"u")return null;const d=window.API_BASE_URL;return d?d.replace(/\/$/,""):null}const B=["image/png","image/jpeg","image/jpg","image/gif","image/webp"],C=()=>{const{user:d}=S(),{logo:c}=k(),[s,y]=n.useState(null),[u,N]=n.useState("Funkedupshift"),[r,x]=n.useState(null),[g,p]=n.useState(!1),[f,m]=n.useState(null),[h,a]=n.useState(null);if(!A(d??null,"superadmin"))return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-50",children:"Branding"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Only superadmin users can manage global branding assets."})]});const v=i=>{var o;const l=(o=i.target.files)==null?void 0:o[0];y(l??null),m(null),a(null),r&&(URL.revokeObjectURL(r),x(null)),l&&x(URL.createObjectURL(l))},U=async i=>{if(i.preventDefault(),a(null),m(null),!s){a("Choose an image file first.");return}const l=s.type||"image/png";if(!B.includes(l)){a("Logo must be PNG, JPEG, GIF, or WEBP.");return}const o=R();if(!o){a("API URL not configured.");return}const b=window;if(!b.auth||typeof b.auth.getAccessToken!="function"){a("Auth not initialized.");return}p(!0);try{const t=await E(`${o}/branding/logo`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contentType:l,alt:u})});if(!t.ok){const P=await t.text();throw new Error(P||`Metadata request failed with ${t.status}`)}const j=await t.json();if(!j.uploadUrl)throw new Error("uploadUrl missing from response.");const w=await fetch(j.uploadUrl,{method:"PUT",headers:{"Content-Type":l},body:s});if(!w.ok)throw new Error(`Upload failed with ${w.status}`);m("Logo updated. It may take a moment for caches to refresh.")}catch(t){a((t==null?void 0:t.message)??"Failed to update logo.")}finally{p(!1)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-50",children:"Branding"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Upload a new global logo for Funkedupshift. This logo is used in the navigation bar and other shared surfaces."})]}),e.jsxs("form",{className:"space-y-4 max-w-md",onSubmit:U,children:[e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("label",{className:"block text-slate-200",children:"Logo image"}),c&&!r&&e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsx("p",{className:"text-slate-200",children:"Current logo"}),e.jsx("div",{className:"inline-flex items-center rounded-lg border border-slate-800 bg-slate-950 p-2",children:e.jsx("img",{src:c.url,alt:c.alt,className:"h-12 w-auto rounded-md object-contain"})})]}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/gif,image/webp",onChange:v,className:"block w-full text-xs text-slate-300 file:mr-3 file:rounded-md file:border-0 file:bg-slate-800 file:px-3 file:py-1.5 file:text-xs file:font-semibold file:text-slate-100 hover:file:bg-slate-700"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PNG, JPEG, GIF, or WEBP. Recommended square or horizontal layout."})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("label",{className:"block text-slate-200",children:"Alt text"}),e.jsx("input",{type:"text",value:u,onChange:i=>N(i.target.value),className:"w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-50 placeholder:text-slate-500 focus:border-brand-orange focus:outline-none focus:ring-1 focus:ring-brand-orange"})]}),r&&e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("p",{className:"text-slate-200",children:"Preview"}),e.jsxs("div",{className:"inline-flex items-center rounded-lg border border-slate-800 bg-slate-950 p-2",children:[e.jsx("img",{src:r,alt:"Preview",className:"h-12 w-auto rounded-md object-contain"}),e.jsx("span",{className:"ml-3 text-xs text-slate-400 truncate max-w-[12rem]",children:s==null?void 0:s.name})]})]}),e.jsx("button",{type:"submit",disabled:g||!s,className:"inline-flex items-center justify-center rounded-md bg-brand-orange px-4 py-2 text-sm font-semibold text-slate-950 hover:bg-orange-500 disabled:opacity-50",children:g?"Updatingâ€¦":"Update logo"}),f&&e.jsx("div",{className:"rounded-md border border-emerald-500/60 bg-emerald-500/10 px-3 py-2 text-xs text-emerald-200",children:f}),h&&e.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-xs text-red-200",children:h})]})]})};export{C as default};
