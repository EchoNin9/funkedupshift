import{u as N,r as l,f as y,h as k,j as e,L as w,_ as j,F as A}from"./index-BLy7dBGz.js";function E(){if(typeof window>"u")return null;const o=window.API_BASE_URL;return!o||o==="API_URL_PLACEHOLDER"||!o.startsWith("http")?null:o.replace(/\/$/,"")}const P=()=>{const{user:o}=N(),[n,p]=l.useState([]),[d,c]=l.useState(null),[g,u]=l.useState(!0),[m,x]=l.useState(null),v=l.useCallback(async()=>{const t=E();if(!t){x("API URL not set. For local dev, edit public/config.js and set window.API_BASE_URL to your staging API (e.g. terraform -chdir=infra output -raw apiInvokeUrl)."),u(!1);return}u(!0),x(null);try{const r=await y(`${t}/recommended/highlights`),s=await r.text();if(!r.ok)throw new Error(s||`HTTP ${r.status}`);if(s.trim().startsWith("<"))throw new Error("API returned HTML instead of JSON. For local dev, set window.API_BASE_URL in public/config.js to your staging API URL (e.g. terraform -chdir=infra output -raw apiInvokeUrl)");let i;try{i=JSON.parse(s)}catch{throw new Error("API returned invalid JSON.")}const h=Array.isArray(i.sites)?i.sites:[];p(h),x(null)}catch(r){const s=r instanceof Error?r.message:"Failed to load.";x(s),p([])}finally{u(!1)}},[]);l.useEffect(()=>{v()},[v]);const f=k(o??null,"manager");return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-violet-200",children:"Highlights and faves"}),e.jsxs("div",{className:"rounded-xl border border-violet-800/60 bg-gradient-to-br from-violet-900/40 to-violet-950/60 p-4 shadow-lg",children:[e.jsx("p",{className:"text-sm font-medium text-violet-100",children:"Our curated list of exceptional sites"}),e.jsx("p",{className:"mt-1 text-xs text-violet-200/80",children:"Click a card below for more detail"}),f&&e.jsx("p",{className:"mt-2",children:e.jsx(w,{to:"/admin/recommended?tab=highlights",className:"text-violet-300 hover:text-violet-200 font-semibold text-sm",children:"Edit sites list"})})]}),g&&e.jsx("p",{className:"text-sm text-slate-400",children:"Loadingâ€¦"}),m&&!n.length&&e.jsx("div",{className:"rounded-md border border-red-500/60 bg-red-500/10 px-3 py-2 text-xs text-red-200",children:m}),!g&&n.length===0&&!m&&e.jsxs("p",{className:"text-sm text-slate-400",children:["No sites configured yet."," ",f&&e.jsx(w,{to:"/admin/recommended?tab=highlights",className:"text-violet-400 hover:text-violet-300",children:"Add sites"})]}),n.length>0&&e.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(260px,1fr))] gap-4",children:n.map(t=>{const r=(t.status||"up").toLowerCase(),s=r==="up"?"border-violet-400/50 bg-violet-400/20 text-violet-200":r==="degraded"?"border-violet-500/50 bg-violet-500/15 text-violet-200":"border-violet-600/50 bg-violet-600/15 text-violet-200",i=(t.description||"").trim().length>0,h=t.title||t.domain,b=t.url||`https://${t.domain}`;return e.jsxs("div",{className:`rounded-lg border p-4 text-left text-sm min-w-0 cursor-pointer transition-all duration-200 hover:scale-[1.01] hover:shadow-lg ${s}`,onClick:()=>c(t),role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),c(t))},children:[e.jsxs("span",{className:"relative group block",children:[e.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"font-semibold block hover:underline break-all",onClick:a=>a.stopPropagation(),children:h}),e.jsx("span",{className:"absolute left-0 top-full mt-1 px-2 py-1.5 rounded bg-slate-900 border border-violet-700/60 text-xs text-violet-200 break-all max-w-[280px] shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-10 pointer-events-none",role:"tooltip",children:b})]}),i&&e.jsx("div",{className:"mt-2 text-xs text-violet-200/90 leading-relaxed break-words",children:t.description})]},t.url||t.domain)})}),e.jsxs(j,{open:!!d,onClose:()=>c(null),className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(j.Panel,{className:"mx-auto w-full max-w-xl rounded-xl border border-violet-800/60 bg-gradient-to-br from-violet-900/40 to-violet-950/60 p-6 shadow-xl",children:d&&e.jsxs("div",{className:"relative flex min-h-[12rem] items-center justify-center",children:[e.jsx("button",{type:"button",onClick:()=>c(null),className:"absolute right-0 top-0 rounded p-1 text-violet-400 hover:bg-violet-800/40 hover:text-violet-200","aria-label":"Close modal",children:e.jsx(A,{className:"h-6 w-6"})}),d.logoUrl?e.jsx("img",{src:d.logoUrl,alt:"",className:"max-h-48 max-w-full object-contain",onError:t=>{t.currentTarget.style.visibility="hidden"}}):e.jsx("div",{className:"h-24 w-24 rounded-lg border border-violet-700/60 bg-violet-900/40"})]})})})]})]})};export{P as default};
